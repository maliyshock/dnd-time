@use "../../../scss/mixins";

$steps-count: 3;

.clocks:hover, .clocks__item-wrapper .time-changer.highlighted {
	.time-changer__value {
		display: block;
		opacity: 1;
	}
}

.time-changer.highlighted  * {
	transition: unset!important;
}

.clocks__item-wrapper:hover, .clocks__item-wrapper .time-changer.highlighted {
	.time-changer__button {
		color: color-mix(in srgb, var(--color-white), transparent 85%);
	}
}

.time-changer.highlighted {
	.time-changer__steps {
		opacity: 1;
		border-color: var(--muted-white);

		@starting-style {
			opacity: 0;
		}
	}

	&__step-item {
		opacity: 1;
		transform: translateY(0);
	}

	&:where(.descender) {
		@for $i from 1 through $steps-count {
			.time-changer__step-item:nth-child(#{$i}) {
				transition-delay: calc(var(--transitionTime) * ($i));
			}
		}
	}

	&:where(:not(.descender)) {
		@for $i from 1 through $steps-count {
			.time-changer__step-item:nth-child(#{$i}) {
				transition-delay: calc(var(--transitionTime) * ($steps-count - $i));
			}
		}
	}
}


.time-changer {
	--transitionTime: 0.2s;
	--transitionTimeXL: 0.6s;
	--transitionTime2XL: 1s;

	$c: &;

	position: relative;

	&:where(.descender) {
		#{$c}__icon {
			transform: scale(1, -1);
		}

		#{$c}__value {
			margin-top: auto;
			margin-bottom: calc(var(--spacing) * (2));

			@include mixins.for-tablet-portrait-up {
				margin-bottom: calc(var(--spacing) * (3));
			}
		}

		#{$c}__steps-wrapper {
			bottom: auto;
			top: calc(100% + var(--spacing) * 4);
		}

		#{$c}__step-item {
			transform: translateY(-100%);
		}

		@for $i from 1 through $steps-count {
			#{$c}__step-item:nth-child(#{$i}) {
				transition-delay: calc(var(--transitionTime) * ($steps-count - $i));
			}
		}
	}


	&:where(:not(.descender)) {
		#{$c}__step-item {
			transform: translateY(100%);
		}

		@for $i from 1 through $steps-count {
			#{$c}__step-item:nth-child(#{$i}) {
				transition-delay: calc(var(--transitionTime) * ($i));
			}
		}
	}

	&.highlighted, &:hover {
		 #{$c}__value {
			opacity: 1;
			display: block;

			@starting-style {
				opacity: 0;
			}
		}

		#{$c}__button {
			stroke: var(--muted-white);
			stroke-width: 2px;
		}

		#{$c}__step-item {
			opacity: 1;
			transform: translateY(0);
		}
	}

	&__button-wrapper {
		position: relative;
		width: 100%;
		z-index: 1;
	}

	&__button {
		margin: 0;
		@include mixins.reset-button;
		cursor: pointer;
		pointer-events: all;

		display: flex;
		justify-content: center;
		align-items: center;
		color: color-mix(in srgb, var(--color-white), transparent 95%);

		width: clamp(2.4rem, 8vw, 3.75rem);
		height: clamp(2.4rem, 8vw, 3.75rem);

		background: transparent;
		outline: none;
		border: none;
		box-shadow: none;

		transition: stroke var(--transitionTime), color var(--transitionTime);

		stroke: color-mix(in srgb, var(--color-white), transparent 100%);

		&:active {
			transform: scale(0.95);
		}
	}

	&__value {
		opacity: 0;
		display: none;

		transition: display var(--transitionTime), opacity var(--transitionTime);
		transition-behavior: allow-discrete;

		@starting-style {
			opacity: 0;
		}
	}

	&__step-value {
		opacity: 0;
		display: inline-flex;
		transform: scale(0);
		transition: opacity var(--transitionTime), transform var(--transitionTime);
		color: var(--muted-white);

		&:hover {
			color: color-mix(in srgb, var(--color-white), transparent 0%);
		}
	}

	&__steps-wrapper {
		display: flex;
		z-index: 0;
		position: absolute;
		width: 100%;
		bottom: calc(100% + var(--spacing) * 4);
		flex-wrap: wrap;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		transition: transform var(--transitionTime2XL);
	}

	&__steps {
		overflow: hidden;
		border: 1px solid transparent;

		&:hover {
			border-color: var(--muted-white);
		}

		transition: border-color var(--transitionTime);
	}

	&__steps:hover, &.highlighted {
		#{$c}__step-value {
			transform: scale(1);
			opacity: 1;
		}

		#{$c}__step-button {
			background-color: transparent;
			transform: scale(1);
		}
	}

	&__step-item {
		opacity: 0;
		display: flex;
		justify-content: center;
		align-items: center;
		width: calc(var(--spacing) * 12);
		height: calc(var(--spacing) * 12);

		transition-behavior: allow-discrete;
		transition: transform var(--transitionTime), opacity var(--transitionTime);
	}

	&__step-button {
		display: flex;
		justify-content: center;
		align-items: center;
		background-color: var(--color-white);
		width: var(--spacing);
		height: var(--spacing);
		border-radius: 100%;

		transform: scale(0.6);
		transition: transform  var(--transitionTime);
	}

	&__value {
		color: var(--color-white);

		margin-top: calc(var(--spacing) * (2));

		@include mixins.for-tablet-portrait-up {
			margin-top: calc(var(--spacing) * (3));
		}
	}
}
